<!-- 報價人員基本資料 -->
<div class="mb-2 bg-base-200 p-4 rounded-sm" [formGroup]="form()">
  <h3 class="text-base font-semibold mb-3 flex items-center gap-2">
    <lucide-icon
      [img]="MessageSquareQuote"
      [size]="18"
      class="text-base-content/70"
    />
    報價人員資料
  </h3>
  <div class="grid grid-cols-2 gap-x-3">
    <!-- Quoter Name -->
    <fieldset class="fieldset col-span-2 md:col-span-1">
      <legend class="fieldset-legend">
        報價公司/人員
        <span class="text-error">*</span>
      </legend>
      <label
        class="input w-full"
        [ngClass]="
          form().get('quoterName')?.touched &&
          form().get('quoterName')?.errors?.['required']
            ? 'input-error'
            : ''
        "
      >
        <lucide-icon
          [img]="UserRound"
          [size]="16"
          class="opacity-70"
        />
        <input
          formControlName="quoterName"
          type="text"
          placeholder="請輸入報價人員"
        />
      </label>
      @if (
        form().get('quoterName')?.touched &&
        form().get('quoterName')?.errors?.['required']
      ) {
        <p class="text-error">請輸入報價人員</p>
      }
    </fieldset>

    <!-- Tax ID -->
    <fieldset class="fieldset col-span-2 md:col-span-1">
      <legend class="fieldset-legend">統一編號</legend>
      <label
        class="input w-full"
        [ngClass]="
          form().get('quoterTaxID')?.touched &&
          form().get('quoterTaxID')?.invalid
            ? 'input-error'
            : ''
        "
      >
        <lucide-icon
          [img]="ReceiptText"
          [size]="16"
          class="opacity-70" />
        <input
          formControlName="quoterTaxID"
          type="text"
          inputmode="numeric"
          placeholder="請輸入統一編號"
          maxlength="8"
      /></label>
      @if (
        form().get('quoterTaxID')?.touched &&
        form().get('quoterTaxID')?.invalid
      ) {
        <p class="text-error">
          {{ form().get('quoterTaxID')?.errors?.['taxId']?.message }}
        </p>
      }
    </fieldset>

    <!-- Email -->
    <fieldset class="fieldset col-span-2 md:col-span-1">
      <legend class="fieldset-legend">
        E-mail<span class="text-error">*</span>
      </legend>
      <label
        class="input w-full"
        [ngClass]="
          form().get('quoterEmail')?.touched &&
          (form().get('quoterEmail')?.errors?.['required'] ||
            form().get('quoterEmail')?.errors?.['email'])
            ? 'input-error'
            : ''
        "
      >
        <lucide-icon [img]="Mail" [size]="16" class="opacity-70" />
        <input
          formControlName="quoterEmail"
          type="email"
          placeholder="請輸入電子信箱"
        />
      </label>
      @if (
        form().get('quoterEmail')?.touched &&
        form().get('quoterEmail')?.errors?.['required']
      ) {
        <p class="text-error">請輸入電子信箱</p>
      } @else if (
        form().get('quoterEmail')?.touched &&
        form().get('quoterEmail')?.errors?.['email']
      ) {
        <p class="text-error">錯誤的電子信箱格式</p>
      }
    </fieldset>

    <!-- Phone -->
    <fieldset class="fieldset col-span-2 md:col-span-1">
      <legend class="fieldset-legend">聯絡電話</legend>
      <div class="flex gap-2">
        <label
          class="input w-full flex-1"
          [ngClass]="
            form().get('quoterPhone')?.touched &&
            form().get('quoterPhone')?.errors?.['phone']
              ? 'input-error'
              : ''
          "
        >
          <lucide-icon [img]="Phone" [size]="16" class="opacity-70" />
          <input
            formControlName="quoterPhone"
            type="tel"
            placeholder="09xx-xxx-xxx 或 0x-xxxx-xxxx"
          />
        </label>
        <label class="input w-24 flex-shrink-0">
          <input
            formControlName="quoterPhoneExt"
            type="text"
            placeholder="分機"
          />
        </label>
      </div>
      @if (
        form().get('quoterPhone')?.touched &&
        form().get('quoterPhone')?.errors?.['phone']
      ) {
        <p class="text-error text-xs mt-1">
          {{ form().get('quoterPhone')?.errors?.['phone']?.message }}
        </p>
      }
    </fieldset>
  </div>

  <!-- 報價方進階資料 (預設收合) -->
  <div class="collapse collapse-arrow mt-2 bg-base-200">
    <input type="checkbox" />
    <div
      class="collapse-title text-sm font-semibold py-3 after:start-5 after:end-auto pe-4 ps-12"
    >
      填寫更多
    </div>
    <div class="collapse-content">
      <div class="grid grid-cols-2 gap-x-3">
        <!-- Quoter Logo Upload -->
        <fieldset class="fieldset col-span-2 md:col-span-1">
          <legend class="fieldset-legend">公司 LOGO</legend>
          <app-file-upload
            [label]="'上傳公司 LOGO'"
            [previewUrl]="quoterLogo()"
            [variant]="'compact'"
            (fileSelected)="onQuoterLogoChange($event)"
            (fileRemoved)="onQuoterLogoRemove()"
          />
        </fieldset>

        <!-- Stamp Upload -->
        <fieldset class="fieldset col-span-2 md:col-span-1">
          <legend class="fieldset-legend">公司發票章</legend>
          <app-file-upload
            [label]="'上傳公司發票章'"
            [previewUrl]="stamp()"
            [variant]="'compact'"
            (fileSelected)="onStampChange($event)"
            (fileRemoved)="onStampRemove()"
          />
        </fieldset>

        <!-- Address -->
        <fieldset class="fieldset col-span-2">
          <legend class="fieldset-legend">公司地址</legend>
          <label class="input w-full">
            <lucide-icon
              [img]="MapPin"
              [size]="16"
              class="opacity-70"
            />
            <input
              formControlName="quoterAddress"
              type="text"
              placeholder="請輸入地址"
            />
          </label>
        </fieldset>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-2 gap-x-3">
    <fieldset class="fieldset">
      <legend class="fieldset-legend">報價日期</legend>
      <label class="input w-full">
        <lucide-icon
          [img]="Calendar1"
          [size]="16"
          class="opacity-70"
        />
        <input
          #startDate
          id="startDate"
          formControlName="startDate"
          type="text"
          placeholder="報價日期"
          autocomplete="off"
        />
      </label>
    </fieldset>

    <fieldset class="fieldset">
      <legend class="fieldset-legend">有效日期</legend>
      <label class="input w-full">
        <lucide-icon
          [img]="Calendar1"
          [size]="16"
          class="opacity-70"
        />
        <input
          #endDate
          id="endDate"
          formControlName="endDate"
          type="text"
          placeholder="------"
          autocomplete="off"
        />
      </label>
    </fieldset>
  </div>
</div>
